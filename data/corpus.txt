Simulating Formula One Race Strategies Claudia Sulsters Research Paper MSc Business Analytics Vrije Universiteit Amsterdam Faculty of Sciences De Boelelaan a HV Amsterdam Supervisor R Bekker February Abstract The goal of this research is to build a simulation model that can be used by Formula One teams to determine the optimal race strategy among a set of possible strategies The simulation model describes the in uence of fuel consumption and tire degradation on the lap times based on observed lap time data from races of the season In addition the simulation model imitates most on track events including the mixing of the cars at the start of a race pit stops overtaking actions safety car situations and driver retirements The performance of the simulation model is evaluated using four races of the season The results show that the simulated positions are highly correlated with the actual positions implying that the model performs well in predicting the race results However the race times are often under or overestimated Finally we illustrate how the simulation model can be used by Formula One teams by simulating di erent race strategies and comparing the results Keywords Formula One Discrete Event Simulation Linear Regression Bayesian Inference Preface The amounts of data that are generated in Formula One inspire me in my work as a mathematician but also the sport itself intrigues me After my rst actual visit to a Formula One race the Spanish Grand Prix I have never missed a free practice a quali cation session or a race When I saw the fast cars driving around the corners of the circuit de Catalunya I knew that I wanted to learn more about the sport Therefore it was not di cult to choose the subject of my research paper for the master Business Analytics This research paper aims at simulating race strategies for Formula One races using open source data It combines my passions for Formula One mathematics and data science I would like to thank my supervisor Ren Bekker for the advice and guidance throughout the research process Contents Introduction Formula One background Data analysis Model description Model design Modeling lap times Fuel model Tire model Lap time variability Crashes Did Not Finish and safety cars Mixing of the cars at the start Overtaking model Pit stop strategies Model evaluation Evaluation of the simulated overtaking actions Evaluation of the simulated positions Evaluation of the simulated race times Comparing pit stop strategies Results Model parameters Evaluation of the simulated overtaking actions Evaluating the simulated positions and race times Comparing pit stop strategies Discussion and conclusion Introduction One may say that Formula One races are won in the factory instead of on the circuit Formula One teams collect tremendous amounts of real time data in order to predict the performance of their race cars The McLaren team for example builds its race cars for each circuit based on historical data and simulations generated by the current season s sensor data The Red Bull Racing team has sixty engineers present in the pit box and thirty in England during a Formula One race weekend The data from the farthest circuit in Australia reaches the Red Bull s U K team in less than milliseconds to run simulations to determine or adjust the race strategy whenever a tire change or an overtaking opportunity occurs This is because strategy decisions can be crucial in winning a Formula One race Simulating the result of a race given a particular strategy can help Formula One teams planning and evaluating their race strategies possibly leading to competitive advantages J Bekker and W Lotz have designed and evaluated a discrete event simulation model that can be used for planning Formula One race strategies Bekker and Lotz divide the circuit in a number of sectors and simulate a sector time for each sector using detailed on track data of Formula One cars such as fuel consumption tire degradation and air resistance The simulation model imitates most on track events including car failures overtaking and pit stops However the simulation model was published by Bekker and Lotz back in and cannot be used to simulate Formula One races today because of the regulations being yearly revised by the F d ration Internationale de l Automobile s FIA the governing body of Formula One As a result the regulations during the season di er strongly from the regulations of the season First the FIA has decided that refueling during the race is no longer permitted from the season onwards This implies that refueling is no longer included in a pit stop while it was in Second the Drag Reduction System DRS which facilitates overtaking between Formula One cars was introduced in As a result the average number of overtaking actions per race has increased from in to in Since the temporary speed advantage resulting from the DRS is not taken into account by Bekker and Lotz the overtaking model needs to be adjusted in order to be used in a simulation model today Third the deployment of the safety car which can highly in uence the race strategy is not included in the model of Bekker and Lotz Finally it should be noted that Formula One cars are improved each season to be able to drive faster and to make races more spectacular which makes the data on the performance of race cars in unusable today In this research a discrete event simulation model is developed that is able to simulate races of the season Since the model uses lap time data from races of the season the performance of the Formula One racing cars is very well re ected in the model Furthermore most important changes in regulations such as the use of the DRS and the deployment of the safety car are included in the model The research goal is to build a simulation model that can be used by Formula One teams to determine the optimal race strategy among a set of possible strategies We de ne the optimal race strategy as the strategy that maximizes the expected positions of both drivers in the team The simulation model describes the in uence of fuel consumption and tire degradation on the lap time based on observed lap time data from races of the season In addition the simulation model imitates most on track events including the mixing of the cars at the start of a race pit stops overtaking ac tions safety car situations and driver retirements This research is limited to the use of open source data that can be found on the internet since Formula One racing teams do not have their data freely available This paper is structured as follows Section provides the reader with relevant background information on the subject of Formula One racing The data that is used in this research is analyzed in Section Section focuses on the design and the implementation of the simulation model Finally the results are presented and discussed in Section whereafter conclusions are drawn in Section Formula One background Formula One originates from the pre war European Grand Prix championships of the s and s However we may say that it was o cially founded in when the FIA introduced the rst standardized rules In the FIA introduced the rst o cial World Championship for Drivers using the Formula One rules This World Championship consisted of six European Grand Prix and the Indianapolis Formula One refers to a set of technical regulations for single seater open cockpit racing cars These regulations are published annually by the FIA The FIA Formula One World Championship consisted of twenty one Grand Prix located all over the world Eleven teams constructors consisting of two drivers competed in two championships the Constructor s World Championship and the Drivers World Championship The driver that has the most championship points receives the Driver s World Championship title while the teams compete for the Constructor s World Championship title The drivers and teams are awarded championship points each Grand Prix based on their nal positions A race weekend consists of two free practices on Friday a free practice and a qualifying session on Sat urday and the race on Sunday During the free practice sessions the circuit is available for the teams and the drivers to work on the set up of their cars in preparation of the qualifying session and the race Engineers and mechanics use detailed on track data of the racing cars to optimize the performance of the car on the circuit In general a balance must be found between the top speed of a Formula One car and its down force High down force is necessary to drive fast through the corners of the circuit while a high top speed is necessary on the long straights Not having the right balance in the car will cause understeer or oversteer in the corners Understeer is used to refer to the situation that the front end of the car refuses to turn into a corner and slides wide while oversteer refers to the situation that the rear end of the car refuses to go around the corner and tries to overtake the front end of the car Furthermore the aero dynamica has a high in uence on the performance of a Formula One car The chassis the main part of a racing car to which the engine and suspension are attached is therefore also optimized by the engineers On Saturday the drivers compete in the qualifying session trying to achieve a high position on the start ing grid The qualifying format was revised after the rst two races of the season Here we discuss the format that was used for the majority of the races In this format the qualifying session consists of three knock out sessions Q Q and Q The rst knock out session Q has a duration of eighteen minutes in which all cars will be permitted on the circuit At the end of the session the slowest six cars are excluded from the qualifying session and the lap times achieved by the sixteen remaining cars will then be deleted The second knock out session Q has a duration of fteen minutes The sixteen remaining cars will be permitted on the track and at the end of this period again the slowest six cars are excluded from the qualifying session while the lap times achieved by the ten remaining cars will be deleted The last session Q or top qualifying has a duration of twelve minutes The remaining ten cars are permitted on the circuit to compete for the top positions on the starting grid Especially the battle for pole position the rst place on the starting grid is a erce one Although the qualifying sessions determine the position of the drivers on the starting grid drivers can receive a grid penalty of a few positions by violating the technical regulations of the FIA The Formula One teams and drivers compete for the championship points during the race on Sunday The most spectacular moment is probably the start of the race since this is one of the best opportunities to gain one or more positions The race starts when the red lights go out and the eld accelerates away towards the rst corner It is not unusual to see two or more cars simultaneously taking the rst corner Contact between cars is sometimes unavoidable as the cars are heavy with fuel have relatively cold brakes and tires and are o the normal racing line trying to overtake each other During the race each driver may visit his team in the pits to replace his current set of tires by a fresh set of tires which is known as a pit stop The tire producer of Formula One tires Pirelli produces ve di erent types of dry weather tires ultrasoft tires supersoft tires soft tires medium tires and hard tires These di erent types of tires di er in durability and grip In general softer compounds have more grip and lower durability while harder compound have less grip but high durability In addition Pirelli produces two wet weather tires which are the intermediate tires and the wet tires The characteristics of the di erent tire compounds are summarized in Table Each car has thirteen sets of dry weather tires four sets of intermediate tires and three sets of wet tires available during a Formula One race weekend The Formula One teams have access to three di erent compounds of the dry weather tires Pirelli nomi nates two mandatory sets for each car for the race which can be of di erent compounds and one set of the softest compound that can only be used in the Q qualifying session Usually Pirelli chooses a prime tire and an option tire The prime tire is in theory most appropriate for the circuit s characteristics and is normally harder than the option tire The option tire is not expected to be as appropriate as the prime tire but may provide certain advantages in terms of pace or durability The Formula One teams are free to choose the remaining ten sets of dry weather tires A decent race strategy is essential for winning races A race strategy is determined by the choice of the tires and the laps in which the pit stops are made One important aspect of planning a pit stop is where in the eld the driver would reemerge after the pit stop One well known pit stop strategy is undercutting or overtaking in the pit lane Assume that a car is right behind a slower car that is hard to overtake The trailing car can decide to make an early pit stop then return on the track in clean air and drive some fast laps on his new tires Using this strategy the faster car tries to ensure that the slower car emerges behind him after the slower car makes his pit stop Since it is not known in advance of the race whether such an overtaking opportunity will occur Formula One teams use a system of pit stop windows instead of xed pit stop timetables Furthermore it can be very bene cial to make a pit stop when the safety car is deployed A safety car can be deployed by the Race Director when he wants to reduce speed for safety reasons for instance after an accident or because of heavy rain After the race the top three drivers are honored in a podium ceremony The trophies are raised and the championship points are awarded Compound Ultrasoft Supersoft Soft Medium Hard Intermediate Wet light standing water Wet heavy standing water Wet Driving conditions Dry Dry Dry Dry Dry Grip Durability Table Characteristics of the tire compounds available during the season Tires are ranked on grip and durability at a scale from highest to lowest Data analysis The data that is used in this research consists of driver s lap times from each race during the season This data is retrieved from the Ergast Developer API ergast com which is an experimental web service that provides data for the Formula One series from the beginning of the World Championship in The World Championship consisted of twenty one races all over the world In the following sections we will use this data set to illustrate the methods that are used to model the di erent components of the simulation model This section analyses the lap time data as retrieved from the Ergast Developer API Figure shows Nico Rosberg s lap times for each lap during the Grand Prix of Europe Baku in We can observe that the lap time of the rst lap is considerably higher than the lap times that follow the rst lap laps This is caused by the start of the race for three important reasons First Formula One drivers need tenths of seconds to react to the red lights going out and a few seconds to accelerate away from the grid towards the rst corner Second drivers try to gain one or more positions in their run to the rst corner resulting in some time loss in the rst lap Third drivers need to warm up their brakes and tires in the rst lap which again has a negative in uence on the lap time In addition we can observe an in lap at lap and a pit stop in lap During the in lap drivers slow down to enter the pit lane entrance whereafter the driver stops at his pit box to replace his current tires by a new set of tires During the European Grand Prix Nico Rosberg completed two di erent stints i e a set of consecutive laps on two di erent sets of tires However from the lap time data it is not possible to derive the tire compounds that were used during these stints We can also observe a decreasing trend in the lap times over the duration of the race which is caused by fuel consumption On the other hand it is known that the lap times increase at the beginning and the end of a stint This is caused by a relatively low temperature of the tires at the beginning of the stint and by tire degradation at the end of a stint We can conclude that we have to estimate the in uence of both fuel consumption and tire degradation on the lap times in order to simulate realistic lap times Finally some lap time variability is present in the lap times especially during the second stint The original data as retrieved from ergast com contains the lap time and position of a driver during each lap of a Formula One race but does not contain the tire compound that is used in each lap the age of the tires and the fuel level Therefore this data is enriched with pit stop strategy data and fuel level data to obtain a complete dataset that can be used to estimate the in uence of fuel consumption and tire degradation on the lap times Table shows an example of the enriched dataset for Nico Rosberg during the European Grand Prix in From the pit stop strategy data we can derive that the pit stop of Nico Rosberg in lap had a duration of seconds and that his set of supersoft tires was replaced by a set of soft tires Nico Rosberg s race strategy thus consisted of a stint on supersoft tires laps and a stint on soft tires laps We can now use the age of a set of tires to estimate the in uence of the tire degradation on the lap time However due to the lack of data we have to make some assumptions on the fuel consumption We assume that the fuel level decreases linearly over the duration of the race having a level of at the start of the race and a level of at the end of the nal lap This implies the assumption that the fuel consumption rate is constant during the race Other data resources that are used in this research are qualifying results the starting grid and race results for each race during the season Also we use manually collected data about safety car situations that have occurred during the season These data on safety car occurrences can be found in Appendix I Figure Nico Rosberg s lap times in seconds during the European Grand Prix Driver Race Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Nico Rosberg Europe Lap Position Lap time Compound Tire age Fuel level Supersoft Supersoft Supersoft Supersoft Soft Soft Soft Soft Table Nico Rosberg s enriched dataset for the European Grand Prix Model description The model that is developed in this research uses discrete event simulation to simulate lap times of drivers during a Formula One race and in addition imitates most on track events including the mixing of the cars at the start of a race pit stops overtaking actions safety car situations and driver retirements This model can be used to simulate the results of races of the season The last ve races of the season are assigned to a test set which can be used to evaluate the performance of the simulation model However we have to remove the Brazilian Grand Prix from the test set since the rainy weather conditions during this race violate the model assumptions which are stated at the end of Section The remaining four races are simulated by the simulation model using data from the training set The training set di ers for each of the four races since it consists of all previous races of the season However the Hungarian Grand Prix is removed from the training set since the qualifying times of the drivers are not representative because of rainy weather conditions during the qualifying session The parameters for simulating the Japanese Grand Prix for example are estimated using lap time data of the rst fteen races Table shows the training set of the Japanese Grand Prix Train Australia Bahrein China Russia Spain Monaco Canada Europe Austria Test Great Britain Germany Belgium Italy Singapore Malaysia Japan Table Training set used to estimate parameters for the Japanese Grand Prix This section is structured as follows Section discusses the design of the simulation model and presents the model assumptions Section presents the model that describes the in uence of the fuel consumption and tire degradation on the lap times How the di erent on track events are included in the model is described in Sections and Finally the methods that are used to evaluate the results of the simulation model are discussed in Section Model design This section describes the design of the simulation model and explains how the di erent components are included in the model We end this section by summarizing the model assumptions According to Law and Kelton a discrete event simulation model describes a system whose state only changes at discrete points in time The system consists of objects called entities that have certain properties called attributes The state of the system is de ned as a collection of attributes or state variables that represents the entities of the system The state may change by the occurrence of an event In this research the entities are the Formula One drivers and their race cars Each driver has certain attributes such as a DNF probability a pit stop strategy and parameters regarding the fuel consumption the tire degradation and the lap time variability The state of the system is de ned by the order of the drivers on the circuit and the cumulative lap time of each driver which is equal to the sum of the lap times of all completed laps The state of the system can only change at the end of each lap Events that can change the state of the system include di erences in lap times between drivers and on track events The simulation model uses the following input data The total number of laps The starting grid The number of positions gained or lost at the start for each individual driver in previous races from the season The DNF status for each individual driver in previous races from the season The set of expected pit stop strategies for each individual driver The average pit stop duration of each Formula One team during that race in the season Driver parameters regarding the fuel consumption the tire degradation and the lap time variability These parameters are estimated for each individual driver using the fuel model and the tire model Figure shows the design of the simulation model A simulation starts with simulating which drivers will not nish the race This is modeled as a realization of the Bernoulli distribution using the DNF probabil ity as probability of success as will be described in Section Next if a driver retires the lap that the driver retires in is drawn arbitrarily The probability of retiring in the rst lap is set equal to a relatively high probability while all other laps are given an equal probability For each driver the expected pit strategy is chosen arbitrarily from a set of possible pit strategies Section describes how this set of possible pit strategies is determined The mixture of cars at the start of the race is modeled in the rst lap The number of positions lost or gained by each driver is determined by drawing a position change from an empirical distribution function The new position of the drivers is computed by adding the position change to the position on the starting grid Section will describe these empirical distribution functions For each lap the simulation model rst determines whether any of the drivers retire in that particular lap That drivers are removed from the simulation and the safety car is deployed with the safety car probability The safety car will be present on the circuit during the safety car period Then a lap time is simulated for each individual driver using the qualifying time the parameters regarding the fuel con sumption and the tire degradation and the estimated lap time variability Section discusses how the parameters regarding the fuel consumption and tire degradation are estimated The fuel level can be determined using the lap number and the total number of laps The expected pit stop strategy is used to determine the tire compound in that particular lap and the age of the tires In each lap we also compute a cumulative lap time for each driver which equals the sum of the lap times of all completed laps The overtaking model adds interactions between drivers to the simulation model After individual lap times of drivers are simulated the overtaking model computes the di erence in cumulative lap time between each consecutive pair of drivers on the circuit The overtaking model determines whether any driver was able to overtake another driver as will be described in Section Finally the expected pit stop strategies are used to determine which drivers do a pit stop in the particular lap Since the pit lane is often located at the start nish pit stops are the last on track events that are added at the end of each lap The pit stop time is estimated using pit stop data of the season for each Formula One team and added to the cumulative lap time The drivers are sorted by their cumulative lap time at the end of each lap We conclude this section by summarizing the model assumptions The Formula One cars do not experience the e ects of air resistance We are not able to model the air resistance as input parameter of the simulation model because of the lack of available data The fuel consumption of each car remains constant for the duration of a race while the tire degra dation is a quadratic function of the number of laps that is driven on the tire compound We make no distinction in di erent causes of retirements of cars The performance of the driver is re ected in the qualifying time The weather conditions remain dry for the duration of a race Only one car may be overtaken at a time except for the rst lap during the mixture of cars after the start The top drivers choose a pit stop strategy from the set of expected pit strategies while the other drivers follow the pit stop strategy from last year s winner Figure Design of the simulation model Modeling lap times In modeling lap times we assume that the lap time consists of a base lap time a fuel bonus a tire penalty and a normally distributed random variable representing the lap time variability lap time base lap time fuel correction tire correction random variability The base lap time is equal to the fastest time a driver achieves during the qualifying session This lap time is achieved with as little fuel as possible on board and on a new warmed up set of tires We assume the base lap time to be the minimum lap time a driver can achieve since the car has higher fuel load aging tires and interactions with other cars during the race The performance of the driver and the car are thus represented in this base lap time The parameters that describe the in uence of fuel consumption and tire degradation on the lap times are estimated for each driver separately based on lap time data of all races in the training set However we cannot use the actual lap times to estimate these parameters because the actual lap times depend on the length of a circuit and its design Therefore the actual lap times are reduced by the fastest qualifying time of a driver and these corrected lap times are used instead of the actual lap times In the following sections the actual lap times are denoted by Y while the corrected lap times are denoted by Y Moreover safety car laps and other outliers are removed from the lap time dataset Section describes the linear regression model that is used to estimate the in uence of fuel consump tion on the lap times Then in Section a quadratic function is estimated on the residuals of the fuel model to estimate the in uence of the tire degradation Finally the standard deviation of the random variable representing the lap time variability is estimated by the standard deviation of the residuals of the fuel model and the tire model We assume this random variable to have a normal distribution with mean equal to and standard deviation equal to the estimated one as is described in Section Fuel model The fuel model is used to estimate the in uence of fuel consumption on the lap times A linear regression model is estimated for each driver separately This is because the intercept of the fuel model represents the average di erence between the lap times of the race and the qualifying time which is driver dependent Also the in uence of the fuel consumption on the lap time depends on the design of the car We de ne the following variables for each driver Yit lap time in lap t on circuit i in seconds Qi fastest qualifying time on circuit i in seconds Yit Yit Qi corrected lap time in lap t on circuit i in seconds X it percentage of remaining fuel at the end of lap t on circuit i cid cid t Ti where t Ti and Ti is equal to the total number of laps on circuit i The corrected lap time as a function of the fuel level can be estimated using a linear regression model Yit X it eit where and are coe cients and eit is the error in the tth corrected lap time The coe cient describes the in uence of the fuel consumption on the lap time The estimated fuel coe cients for each driver can be found in Tire model The tire model is used to estimate the in uence of tire degradation on the lap times In contrast to the fuel model a quadratic regression model is used This is based on the assumption that during a stint on a set of tires the lap times increase slightly at the beginning of the stint because of the tires being relatively cold and at the end of the stint because of tire degradation A strictly convex function is thus expected to be more suitable to model the in uence on the lap times when tire degradation is high However on circuits where tire degradation is not very high a linear regression can also be suitable to model the in uence of tire degradation on the lap times The tire model is estimated for each driver separately since tire degradation highly depends on the driving style We only estimate parameters for the dry weather compounds ultrasoft supersoft soft medium and hard since we assume dry weather conditions during the race De ne the following variables for each driver eit Yit X it residual lap time in lap t on circuit i after estimating the fuel model in seconds X it age of the tires in lap t on circuit i where t Ti The residual lap time as a function of the age of the tires can be estimated using a quadratic regression model eit cid c C c c X it c X it lap on compound c uit uit N where c c and c are coe cients c C ultrasoft supersoft soft medium hard and uit is the error in the tth residual lap time We impose the restriction to ensure that the lap time is modeled as a convex or linear function of the age of the tires Note that when is approximately equal to the lap times are modeled as a linear function of the age of the tires rather than a quadratic strictly convex function The estimated tire coe cients for each driver can be found in Lap time variability We combine the fuel model and the tire model into a nal model that describes the in uence of fuel consumption and the age of the tires on the lap time for each individual driver This model is given by Yit Qi X it cid c C uit N c c X it c X it lap t on compound c uit where the variables are de ned as mentioned before We assume the lap time variability to be a normally distributed random variable with mean equal to and standard deviation estimated by the standard deviation of the residuals uit The estimated standard deviation for each driver can be found in Figure compares the estimated lap times based on the nal model with Nico Rosberg s actual lap times during the European Grand Prix The stint on supersoft tires laps is estimated to be faster than the stint on soft tires laps This is realistic since it is known that drivers are able to drive faster on softer tires with more grip However the lap times during the stint on supersoft tires seem to be structurally underestimated This is caused by the fact that the parameters of the supersoft tires are estimated using all stints on supersoft tires from the training set The lap times within other stints were probably lower than the lap times within the depicted stint causing the underestimation Nevertheless the t of the model is decent Figure Estimated lap times by the fuel and tire model for Nico Rosberg during the European Grand Prix Crashes Did Not Finish and safety cars We model the retirements of drivers during the race by estimating a Did Not Finish DNF probability for each driver based on the nishing status in races from the training set We make no distinction in di erent causes of retirements of drivers such as crashes or mechanical failures One method to estimate the DNF probability of each driver is to use the fraction of not nished races of the total number of races from the training set However the DNF probability is then estimated using a small sample Also drivers that have nished all the races in the training set are assigned a DNF probability equal to while intuitively there is still a small probability of retiring Bayesian inference allows us to use the nishing status of all drivers to estimate the nishing status of a particular driver Bayesian inference requires a probability model to describe the experimental data and a prior distribution The probability model here is that of independent Bernoulli trials since each driver has exactly two outcomes for each race nishing or not nishing The number of not nished races for each driver thus follow independent binomial distributions yj Bin nj j where nj represents the number of observations for driver j which is equal to the number of races in the training set The parameter j represents the DNF probability of driver j The aim of Bayesian inference is to update the prior beliefs on the parameter j based on new data We believe the following on the parameters j The parameter j represents the DNF probability of driver j As a result we believe that j for all j We expect a right skewed prior distribution for the parameter j since it is more likely that the driver never retires than that the driver always retires These prior beliefs should be quanti ed in a prior distribution but nding a prior distribution is in general not straightforward A non informative prior for example would not re ect our strong beliefs about the shape and the domain of the parameter j A Beta distribution however has a more exible shape and is de ned on the interval The Beta distribution has another important property the Beta distribu tion is the conjugate prior of the Bernoulli likelihood A conjugate prior is a choice of a prior distribution that when coupled to a speci c type of likelihood function provides a posterior distribution that is of the same family of the prior distribution When a Beta prior distribution is coupled to a Bernoulli like lihood then the posterior distribution is given by a Beta distribution with certain parameters We can thus simply specify the posterior distribution of the parameters j using this property of conjugate priors First we have to estimate the parameters and of the prior distribution These parameters are estimated by the method of moments using the nishing status of all drivers in all races from the training set The fraction of not nishing is computed for each driver separately The average of these fractions is used as an estimate of the mean of the prior distribution while the sample standard deviation is used as an estimate of the standard deviation of the prior distribution These were computed as and respectively Since we know that the mean and the standard deviation of the Beta distribution are given by cid and we can estimate the value of the parameters and by cid cid and cid cid respectively This results in the parameter estimates and This method of using the data to estimate the parameters of the prior distribution is called empirical Bayes Figure shows the probability density function of the Beta distribution which is used as prior distribution Figure Probability density function of the Beta distribution plotted against the histogram of the empirical distribution of all DNF probabilities The mean of the empirical distribution is indicated in red Using Bayes rule it can be shown that the posterior distribution of a Beta prior distribution and a Bernoulli likelihood equals a Beta z N z distribution where z is the number of successes N is the number of trials and and are the parameters of the prior distribution We can thus determine the posterior distribution of the DNF probability for each driver using the number of DNFs in the training set The DNF probability for each driver is estimated by the mean of the posterior distribution The results are shown in Table Figure shows the posterior distribution for z and z respectively This gure illustrates a left shifted Beta distribution for a relative small number of DNFs and a right shifted Beta distribution for a relative high number of DNFs compared to the prior distribution Bayes inference has thus used the data of all drivers to compute a prior distribution which is then updated based on driver speci c data resulting in a driver speci c posterior distribution In particular a small DNF probability is assigned to drivers that nished all the races in the training set which is preferred over assigning zero probability Next given the retirement of a driver we have to determine in which lap the driver retires We expect the probability that a driver retires in the rst lap to be considerably higher than the probability that a driver retires in any other lap because of the mixture of cars at the start of a race Therefore all laps are assigned equal probability of retiring except for the rst lap which is assigned a probability that is ten times larger When a driver retires the safety car is deployed with a certain probability during a certain number of laps called the safety car period During the safety car period the simulated lap time of each driver is multiplied by the safety car factor which is set to The safety car is deployed with probability during a safety period of laps In this research we assume that the safety car is only deployed after the retirement of a driver The deployment of the safety car because of rainy weather is not included in the model since we assume dry weather conditions during the race The deployment of a safety car can highly in uence the pit stop strategy of Formula One teams Formula One Teams often react to a safety car situation by making an early pit stop if the safety car is deployed shortly before a scheduled stop and within the so called pit window Driver Nico Rosberg Lewis Hamilton Sebastian Vettel Kimi Raikkonen Daniel Ricciardo Max Verstappen Felipe Massa Valtteri Bottas Nico Hulkenberg Sergio Perez Kevin Magnussen Jolyon Palmer Daniil Kvyat Carlos Sainz Marcus Ericsson Felipe Nasr Fernando Alonso Jenson Button Pascal Wehrlein Esteban Ocon Romain Grosjean Esteban Gutierrez Number of DNFs z Posterior distribution Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta Beta DNF probability j Table Estimated DNF probability per driver using Bayesian inference a z b z Figure Posterior distribution for di erent values of z Mixing of the cars at the start The method that is used to model the mixing of cars at the start of the race is based on the method of Bekker and Lotz Bekker and Lotz use discrete empirical distributions based on historical data to describe the probability that a driver gains or loses a nite number of positions at the start of the race In this research the discrete empirical distribution for each driver is based on the positions gained or lost during each race in the training set This results in a very sparse empirical distribution where positive probability mass is only assigned to a few possible positions as can be seen from the histogram in Figure As a consequence the empirical distribution is not a representative distribution to draw from The method of smoothed empirical distributions resolves the problem that the empirical distribution assigns positive probability mass only to a nite number of points Given a sequence of values y y n y i R the smoothed empirical distribution is de ned as a mixture distribution with the following probability distribution function fX x n n cid i f x y i where f is usually a symmetric unimodal probability density function with expectation and variance The smoothed empirical distribution is thus a mixture of probability distribution functions f x y f x y n with variance and centered at the values y y n If we choose the normal distribution with expectation and variance as f then we have fX x n n cid i x y i e To smooth the empirical distribution of positions gained for each driver we choose f to be a normal distribution with parameter equal to The smoothing of the empirical distribution is illustrated in Figure This gure compares a histogram describing the empirical distribution of the number of positions lost or gained by Nico Rosberg with the smoothed empirical distribution The smoothed empirical distribution is used in the simulation model to draw the number of positions a driver loses or gains at the start This number of positions is then added to the position on the starting grid of each driver The resulting position cannot be smaller than or bigger than the total number of drivers If Nico Rosberg for example starts second on the starting grid and gains two positions then he will emerge in the rst position after the rst lap Figure Empirical distribution function describing the positions gained or lost by Nico Rosberg during the start based on the training set compared to the smoothed empirical distribution Overtaking model The model speci ed so far simulates lap times for each individual driver but completely ignores inter actions between drivers during the race The overtaking model is used to model these interactions The most important interactions between drivers are overtaking and crashing This section describes how overtaking is included in the simulation model while modeling crashes retirements has already been discussed in Section Consider two drivers that drive closely behind each other If the trailing car is faster than the leading car then the trailing car can try to overtake the leading car How successful the overtake is depends on the relative speed the distance between the two cars the position on the circuit where the overtake is planned and the defense of the leading car The overtaking model determines whether the trailing car is able to overtake the leading car based on the following parameters DRS bonus tDRS The trailing car receives a DRS bonus a time reduction if the time di erence with the leading car is smaller than second However drivers will not be able to access the DRS for the rst two laps of the race or during a safety car period Overtaking threshold overtaking The trailing car can only overtake the leading car if the time di erence is bigger in absolute value than the overtaking threshold Overtaking probability povertaking The overtaking action is successful with a certain probability Overtaking penalty tovertaking When a driver is successfully overtaken both the driver in the trailing car and the driver in the leading car receive a time penalty Minimum time di erence min The minimum time di erence represents the closest a driver is allowed to run behind another driver Finally the overtaking model takes the deployment of a safety car into account since overtaking is not allowed during a safety car period We will now discuss the design of the overtaking model De ne the following variables Ydj i t estimated lap time in lap t of driver dj on circuit i Cdj i t Cdj i t Ydj i t Cdj i t Cdj i t time correction for all drivers j D where D represents the set of all drivers t Ti and Ti is equal to the total number of laps on circuit i Cdj i t represents the simulated cumulative lap time in lap t of driver dj on circuit i while Cdj i t represents the corrected simulated cumulative lap time After the individual lap time Ydj i t in lap t is simulated for all drivers dj the overtaking model determines whether any driver was able to overtake another driver in the simulated lap First the individual lap time Ydj i t is added to the corrected cumulative lap time of the previous lap t given by Cdj i t for each driver dj Then the overtaking model computes the di erence in cumulative lap time between each consecutive pair of drivers dj dk on the circuit The di erence in cumulative lap time between driver dj and driver dk is given by j k Cdki t Cdj i t where for the positions of the drivers at the end of the lap which are given by p dj and p dk holds that p dj p dk and p dk p dj Thus the di erence in cumulative lap time for each pair of driver is computed as the cumulative lap time of the trailing car minus the cumulative lap time of the leading car If the trailing car dk is faster than the leading car dj then it holds that j k However the trailing car can only overtake the leading car if the di erence in cumulative lap time is smaller than the overtaking threshold overtaking This can be expressed as j k Cdki t Cdj i t overtaking Note that overtaking because otherwise the trailing car is not faster than the leading car If the overtaking action was successful which occurs with the overtaking probability povertaking the cars change positions Both the leading car dj and the trailing car dk receive a time penalty because of the over taking action tovertaking in seconds If the trailing car is not faster than the leading car but the di erence in cumulative lap time is smaller than the DRS threshold DRS then the trailing car receives a DRS bonus tDRS in the next lap Finally the time di erence between every pair of cars at the end of each lap is assumed to be no smaller than the minimum time di erence min After an overtaking action has occurred we also take the car before the trailing car and the leading car into consideration when correcting the cumulative lap times for the minimum time di erence The time correction that is used to compute Cdj i t from Cdj i t thus consists of the time penalty because of overtaking a DRS bonus achieved in the previous lap and a correction to ensure that the time di er ence is no smaller than the minimum time di erence Figure illustrates how the overtaking model works Figure The overtaking model The value of the overtaking parameters di er for each of the races in the test set except for the DRS threshold DRS the DRS bonus tDRS the time penalty after an overtaking action tovertaking and the minimum time di erence min The DRS bonus is chosen in accordance with the regulations of the FIA which state that a driver within one second of a rival car can activate his DRS within designated DRS activation zones However we assume that a driver can activate his DRS in the next lap if the di erence in cumulative time is smaller than DRS at the end of the previous simulated lap since we have no in formation whether this di erence has exceeded the DRS threshold in a DRS zone or at another segment of the circuit The value of the DRS bonus tDRS the time penalty after an overtaking action tovertaking and the minimum time di erence min are based on parameters used in the simulation model of f metrics Table shows the values of these parameters that are used in the simulation model Parameter DRS threshold DRS DRS bonus tDRS Overtaking penalty tovertaking Minimum time di erence min Value second seconds seconds seconds Table Parameter values used in the overtaking model The values of the overtaking threshold overtaking and the overtaking probability povertaking are chosen by comparing the average number of overtaking actions in the simulation model by the actual number of overtaking actions during the race and presented in Section Pit stop strategies The pit stop strategies are included in the simulation model by selecting a set of expected pit stop strategies for each driver while taking the tire regulations into account In each simulation the pit stop strategy is chosen arbitrarily from the set of expected pit stop strategies for each driver Also the lap in which the pit stop is made is determined by drawing from a normal distribution having a mean equal to the planned lap and a standard deviation set to We will now illustrate how the expected pit stop strategies are determined for the Japanese Grand Prix According to Pirelli a two stop strategy seems to be the most probable strategy for the Japanese Grand Prix The soft tire medium tire and hard tire were made available by Pirelli during this race weekend During qualifying the soft tire was used from Q onwards As a result the tire regulations restrict that the top on the starting grid will start the Japanese Grand Prix on soft tires In addition the drivers are obliged to have two sets of hard tires available for the race from which at least one must be used In Mercedes driver Lewis Hamilton won with a two stop strategy starting on medium tires changing again to medium tires in lap and then changing to hard tires in lap The best alternative was a medium hard hard strategy used last year by Nico Rosberg leading to a successful undercut according to Pirelli Based on this information we can make some assumptions on the expected tire strategy followed by the drivers during the Japanese Grand Prix The expected tire strategy for each driver is contained in Table We assume a two stop pit strategy for each driver Each driver has to do at least one stint on the hard tire compound and the top drivers have to start the Japanese Grand Prix on the soft tire The top drivers will thus probably choose one of the following tire strategies Soft Hard Hard Soft Hard Medium and Soft Medium Hard Notice that the strategy Soft Medium Medium is not permitted since the hard tire is chosen as obligated compound In each simulation we arbitrarily choose the tire strategy for each top driver from the set of expected tire strategies We assume that the other drivers will use Lewis Hamilton s winning strategy during the Japanese Grand Prix which was Medium Medium Hard For all drivers we assume that the rst pit stop is planned in lap and the second pit stop is planned in lap The duration of the pit stops is estimated by the average pit stop durations for each team during the Japanese Grand Prix The pit stop duration of Renault and Haas F Team are chosen equal to the average of all pit stop durations since they did not yet compete in the Formula One Championship in Position Driver Tire strategy Nico Rosberg Soft Hard Medium Hard Medium Lewis Hamilton Soft Hard Medium Hard Medium Max Verstappen Soft Hard Medium Hard Medium Daniel Ricciardo Soft Hard Medium Hard Medium Sergio Perez Soft Hard Medium Hard Medium Sebastian Vettel Soft Hard Medium Hard Medium Romain Grosjean Soft Hard Medium Hard Medium Kimi Raikkonen Soft Hard Medium Hard Medium Nico Hulkenberg Soft Hard Medium Hard Medium Esteban Gutierrez Soft Hard Medium Hard Medium Valtteri Bottas Medium Medium Hard Felipe Massa Medium Medium Hard Daniil Kvyat Medium Medium Hard Medium Medium Hard Carlos Sainz Fernando Alonso Medium Medium Hard Jolyon Palmer Medium Medium Hard Kevin Magnussen Medium Medium Hard Medium Medium Hard Marcus Ericsson Medium Medium Hard Felipe Nasr Medium Medium Hard Esteban Ocon Medium Medium Hard Pascal Wehrlein Medium Medium Hard Jenson Button Table Expected tire strategy for each individual driver Formula One team Mercedes AMG Petronas Scuderia Ferrari Red Bull Racing Williams Martini Racing Scuderia Toro Rosso Sahara Force India F Sauber F Team McLaren Honda Manor Racing Renault Haas F Team Average pit stop duration in seconds Table Average pit stop duration for each Formula One team during the Japanese Grand Prix Model evaluation The performance of the simulation model is evaluated by simulating the results of the races in the test set The test set consists of the Japanese Grand Prix the Mexican Grand Prix the Grand of the United States and the Grand Prix of Abu Dhabi The performance of the simulation model is measured using three output parameters of the simulation model The average number of successful overtaking actions during a race The average position of each driver at the end of a race The average race time of each driver at the end of a race The average positions and average race times can be used to validate the fuel and tire model while the average positions and average number of successful overtaking actions can be used to validate the overtaking model However some di culties arise because the output parameters of the simulation model depend on the pit stop strategies retirements safety cars and mixing of the cars at the start of the race Therefore the simulation model is adjusted to be able to validate the fuel and tire model and the overtaking model in a proper way The model is adjusted in such a way that not the estimated values but the actual values are used by simulating the races in the test set The output parameters of the model are evaluated given the actual pit stop strategies the actual DNF s and the actual safety cars situations The set of expected pit stop strategies is replaced by the actual pit stop strategy drivers are removed from the simulated race in the lap they retire and the safety car occurs in actual safety car laps However we do not use the actual number of positions gained at the start of the race because we do also not include the actual overtaking actions We discuss the methods that are used to evaluate the simulation model in more detail in this section These methods are also used by Bekker and Lotz Finally we illustrate how the simulation model can be used by Formula One teams to compare di erent race strategies Evaluation of the simulated overtaking actions The average number of successful overtaking actions is compared to the actual number of overtaking actions to determine an appropriate overtaking threshold overtaking and overtaking probability povertaking for each of the races in the test set These parameters are determined by trial and error The actual and average number of overtaking actions do not include Position changes on the rst lap of the race due to the mixture of cars at the start of the race Position changes due to drivers lapping drivers in the back of the eld Positions gained in the pits during the pit stops Positions gained when a car has retired because of a crash or mechanical failure Evaluation of the simulated positions The Spearman rank correlation coe cient is used to compare the simulated positions of the drivers at the end of the race with the actual positions The simulated position of a driver is equal to the average of the positions of all simulations The Spearman correlation coe cient is de ned as the Pearson correlation coe cient between ranked variables We test the null hypothesis that there is no correlation between the simulated and actual positions at a signi cance level of H H cid where denotes the Pearson correlation coe cient between the ranked variables We de ne the following variables Xi actual position of driver i Yi simulated position of driver i rg Xi ranking of driver i in the vector containing the actual positions rg Yi ranking of driver i in the vector containing the simulated positions and n number of observations Then the rank correlation coe cient can be computed as rs cid n i d i n n where di rg Xi rg Yi and n the number of observations We reject the null hypothesis if and only if the p value is smaller than Rejection of the null hypothesis results in the conclusion that the actual and simulated position are correlated meaning that the ranking of the car positions is not random Evaluation of the simulated race times The simulated race time of a driver is computed as the average race time of all simulations We consider pairs Xi Yi where Xi corresponds to the actual race time of driver i and Yi corresponds to the simulated race time of driver i Since the observations are paired and the respective sets of observations are not expected to be normally distributed the Wilcoxon matched pairs test or Wilcoxon signed rank test is applied to test whether the two samples actual race times and simulated race times di er signi cantly The test assumes that the di erences of matched pairs are centered around a common median and that the underlying distribution is symmetric The following hypothesis is tested at H H cid where denotes the median of the actual race times and denotes the median of the simulated race times This is equivalent to testing whether the median of the distribution of the di erences Zi Yi Xi is signi cantly di erent from So the hypothesis can be rewritten as H mz H mz cid where mz denotes the median of the di erences of matched pairs Let Z Zi mz and let R Rn denote the vector of ranks of Z Zn in the corresponding vector of order statistics This means that Zi is the Ri th in size in increasing order of the Z Zn Then the following test statistic can be constructed n cid V Risgn Zi mz Relatively large values of V indicate that the true distribution of Z Zn has a larger point of symmetry than whereas relatively small values of V indicate a smaller point of symmetry than Note that here we do not want to reject the null hypothesis Not rejecting the null hypothesis implies that there is not enough statistical evidence that the actual and simulated race times di er i Comparing pit stop strategies Finally we illustrate how the simulation model can be used by Formula One teams to compare di erent race strategies Before a race the qualifying lap times the starting grid and the fuel and tire parameters can be used as input for the simulation model to simulate the race results The DNF probabilities and the safety car situations are simulated according to the methods described in Section We conduct a Wilcoxon two sample test also known as the Wilcoxon rank sum test or the Mann Whitney test to test whether the distribution of simulated position for two di erent pit stop strategies di er signi cantly We use this nonparametric test instead of a two sample t test because we expect the normality assumption of the t test not to be valid for the distribution of positions The distribution of positions is more likely to be skewed to the right Let X Xn be the simulated positions using strategy X and Y Yn be the simulated positions using strategy Y where n is equal to the number of simulations that all drivers in the team has nished We combine the two samples into one sample X Xn Y Yn of size N n and let R Rn be the ranks in the combined sample The Wilcoxon two sample test is based on the test statistic W n cid i Ri The null hypothesis that the two samples were selected from populations having the same distribution is rejected for large and small values of W We also create boxplots of the distribution of the simulated positions We use these methods to nd the optimal race strategy for the Mercedes team as well as for their drivers Nico Rosberg and Lewis Hamilton for the Japanese Grand Prix Results This section presents the results that are generated by the simulation model First we give an overview of the model parameters that are used to simulate the races in the test set Then we evaluate the performance of the simulation model based on the average number of overtakes the average positions and the average race times Finally we illustrate how the simulation model can be used by Formula One teams to compare di erent race strategies Model parameters Table contains the model parameters that are used in the simulation model for each race in the test set Symbol Ti tDRS DRS Parameter Number of laps DRS bonus seconds DRS threshold seconds Overtaking threshold seconds overtaking povertaking Overtaking probability tovertaking Overtaking penalty seconds min Minimum gap length seconds psafety car Safety car probability Safety car period laps nsafety car Multiplying factor safety car Csafety car Japan United States Mexico Abu Dhabi Table Parameter values used in the simulation model Evaluation of the simulated overtaking actions Table compares the average number of overtaking actions over simulations with the actual number of overtaking actions per race This table shows that the Mexican Grand Prix had the lowest number of overtaking actions while the Grand Prix of the United States had the highest number of overtaking actions This explains the di erence in the value of the overtaking parameters We use a relatively high in absolute value overtaking threshold and a relatively low overtaking probability while simulating the Mexican Grand Prix This results in a relatively low average number of overtaking actions close to the actual number On the other hand we use a relatively low in absolute value overtaking threshold and a relatively high overtaking probability while simulating the Grand Prix of the United States resulting in a relatively high number of overtaking actions Note that using the actual number of overtaking actions can lead to over tting but unfortunately there is no data available about overtaking actions during the season Actual number Average number of overtakes of overtakes Japan United States Mexico Abu Dhabi Table Average number of overtakes compared to the actual number of overtakes per race Evaluating the simulated positions and race times This section evaluates the performance of the simulation model using the actual pit stop strategies actual retirements and actual safety car situations Tables and compare the actual positions with the simulated positions and the actual race times with the simulated race times for each race in the test set These results are obtained by running simulations Each table also contains the results of the Spearman rank correlation test and the Wilcoxon signed rank test The p value of the Spearman rank correlation test is smaller than for each of the races in the test set which means that the actual and estimated positions are highly correlated The highest correlation is achieved while simulating the Grand Prix of Abu Dhabi while the lowest one is achieved while simulating the Grand Prix of the United States The results of the Wilcoxon matched pairs test di er for the races in the test set Only for the Japanese Grand Prix we cannot reject the null hypothesis that the actual race time and simulated race time have the same underlying distribution The actual race times of the Grand Prix of the United States and the Grand Prix of Abu Dhabi are underestimated while those of the Mexican Grand Prix are overestimated Driver Lewis Hamilton Nico Rosberg Max Verstappen Sebastian Vettel Daniel Ricciardo Valtteri Bottas Felipe Massa Kimi Raikkonen Romain Grosjean Sergio Perez Nico Hulkenberg Jolyon Palmer Fernando Alonso Kevin Magnussen Marcus Ericsson Felipe Nasr Esteban Gutierrez Daniil Kvyat Carlos Sainz Jr Jenson Button Pascal Wehrlein Esteban Ocon Test statistic P value Decision Position Race time Laps Actual Simulated Actual Simulated rs Reject H V Do not reject H Table Actual results of the Japanese Grand Prix compared to the simulated results Driver Lewis Hamilton Nico Rosberg Daniel Ricciardo Sebastian Vettel Carlos Sainz Jr Fernando Alonso Daniil Kvyat Marcus Ericsson Felipe Massa Felipe Nasr Valtteri Bottas Sergio Perez Jolyon Palmer Kevin Magnussen Romain Grosjean Jenson Button Pascal Wehrlein Esteban Ocon Kimi Raikkonen Max Verstappen Esteban Gutierrez Nico Hulkenberg Test statistic P value Decision Position Race time Laps Actual Simulated Actual Simulated rs Reject H V Reject H Table Actual results of the Grand Prix of the United States compared to the simulated results Driver Nico Rosberg Max Verstappen Lewis Hamilton Sebastian Vettel Nico Hulkenberg Kimi Raikkonen Valtteri Bottas Felipe Massa Sergio Perez Daniel Ricciardo Carlos Sainz Jr Fernando Alonso Jenson Button Jolyon Palmer Marcus Ericsson Kevin Magnussen Felipe Nasr Esteban Gutierrez Romain Grosjean Daniil Kvyat Esteban Ocon Pascal Wehrlein Test statistic P value Decision Position Race time Laps Actual Simulated Actual Simulated rs Reject H V Reject H Table Actual results of the Mexican Grand Prix compared to the simulated results Driver Max Verstappen Lewis Hamilton Nico Rosberg Daniel Ricciardo Kimi Raikkonen Sebastian Vettel Sergio Perez Nico Hulkenberg Romain Grosjean Fernando Alonso Felipe Massa Esteban Gutierrez Marcus Ericsson Jolyon Palmer Pascal Wehrlein Felipe Nasr Esteban Ocon Carlos Sainz Jr Daniil Kvyat Jenson Button Valtteri Bottas Kevin Magnussen Test statistic P value Decision Position Race time Laps Actual Simulated Actual Simulated rs Reject H V Reject H Table Actual results of the Grand Prix of Abu Dhabi compared to the simulated results Comparing pit stop strategies This section illustrates how the simulation model can be used by Formula One teams to determine the optimal race strategy among a set of possible strategies We use the simulation model to nd the optimal pit stop strategies for the Mercedes teams as well as for the drivers Nico Rosberg and Lewis Hamilton prior to the Japanese Grand Prix Table describes the pit stop strategies that we consider These pit stop strategies are chosen as follows Strategy is based on Max Verstappen s actual race strategy during the Japanese Grand Prix Max Verstappen made an early pit stop compared to the other drivers but used the same tire compounds as most drivers Strategy is based on Sebastian Vettel s actual race strategy which ended with a stint on soft tires Finally strategy ends with a stint on medium tires according to the actual race strategy of the Force India team Actual strategy Simulated strategies Strategy Strategy Strategy Nico Rosberg Number of planned pit stops Lap numbers of planned pit stops Tyre choice Lewis Hamilton Number of planned pit stops Lap numbers of planned pit stops Tyre choice S H H S H H S H H S H H S H S S H S S H M S H M Table Simulated race strategies for the Japanese Grand Prix We performed simulations for each combination of pit stop strategies The average positions given the driver has nished x y are shown in Table where x represents the average position of Lewis Hamilton and y represents the average position of Nico Rosberg Table shows the average of the sum of the positions given both drivers have nished Lewis Hamilton Nico Rosberg Actual Strategy Strategy Strategy Actual Strategy Strategy Strategy Table Results simulated race strategies for each driver Lewis Hamilton Nico Rosberg Actual Strategy Strategy Strategy Actual Strategy Strategy Strategy Table Results simulated race strategies for the Mercedes team From Table we can determine the optimal strategy for each driver while from Table we can determine the optimal strategy for the Mercedes team Table suggests that the actual strategy is the optimal strategy for Lewis Hamilton but that Nico Rosberg should choose strategy or strategy instead of his actual strategy This can also be seen in the boxplots of Figures a and b where we compare the strategy with Nico Rosberg s actual strategy These boxplots show that Nico Rosberg s median position is smaller for strategy than for the actual strategy We use the Wilcoxon rank rsum test Mann Whitney test to investigate whether the strategy or strategy are indeed better than the actual strategy Table contains the results These results show that strategy is signi cantly better than the other strategies at a signi cance level of since the null hypothesis is rejected We can also conclude that strategy is signi cantly better than the actual strategy Nico Rosberg should thus choose strategy according to the results of the simulation model before the start of the race The results of the simulation model do not show any evidence that Lewis Hamilton should choose another strategy than his actual one a Actual actual b Actual Figure Boxplot of the average positions of the best strategies Strategy Strategy Hamilton Rosberg Hamilton Rosberg Alternative actual actual actual actual actual actual actual actual less less less p value Table Results of the Wilcoxon rank sum test Testing for a di erence in distribution of Nico Rosberg s simulated positions for multiple race strategies denotes rejection at signi cance level However we are interested in the optimal strategy for the Mercedes team rather than the optimal strategy for each driver separately The optimal strategy for the Mercedes team is given by the strategy that maximizes the positions of both drivers i e the sum of the positions The results in Table show that the average of the sum of the positions of both drivers in the team is maximized if Nico Rosberg chooses strategy and Lewis Hamilton chooses his actual strategy As second best strategy Nico Rosberg chooses strategy and Lewis Hamilton chooses his actual strategy The actual race strategy is the third best strategy In the following we will use the notation x y where x denotes the strategy of Lewis Hamilton and y denotes the strategy of Nico Rosberg We now test whether the di erences in the average of the sum of the positions are signi cant The Wilcoxon rank sum test can again be used to test whether the distribution of the sum of the simulated positions di er signi cantly for the di erent strategies We test the null hypothesis that both strategies are equally good against the alternative hypothesis that one strategy performs better than the other strategy strategy The results can be found in Table From this table we can conclude that strategy actual performs better than strategy actual since the true location shift of the distribution of the sum of the positions is signi cantly smaller than at a signi cance level of Strategy actual is also signi cantly better than the actual race strategy of the Mercedes team However strategy actual is not signi cantly better than the actual race strategy because the null hypothesis cannot be rejected at a signi cance level Figure Comparing the average of the sum of the positions of the best strategies Strategy Strategy Hamilton Rosberg Hamilton Rosberg Alternative actual actual actual actual actual actual actual actual less less less p value Table Results of the Wilcoxon rank sum test Testing for a di erence in distribution of the sum of the simulated positions for multiple race strategies denotes rejection at signi cance level The optimal strategy for the Mercedes team is thus given by strategy for Nico Rosberg in combination with the actual pit stop strategy for Lewis Hamilton according to the results of the simulation model Discussion and conclusion The research goal was to build a simulation model that can be used by Formula One teams to determine the optimal race strategy among a set of possible strategies The optimal race strategy was de ned as the strategy that maximizes the positions of both drivers in the team The two main components of the simulation model the tire and fuel model and the overtaking model were validated using races from the test set To simulate race strategies prior to the race we also added most on track events to the simulation model including the mixing of the cars at the start of a race pit stops overtaking actions safety car situations and driver retirements Finally we illustrated how the simulation model can be used by Formula One teams to compare di erent race strategies The performance of the simulation model was evaluated using races from the test set We compared the average number of overtaking actions the average position of each driver at the end of the race and the average race time of each driver with the actual values We can conclude that the simulation model performs well in predicting the actual positions of the drivers but not so well in predicting the actual race times The actual number of overtaking actions were mainly used to obtain suitable parameter values for the overtaking model The high Spearman rank correlation coe cients can imply that the simulated relative di erence in per formance between drivers i e the relative di erence in lap times and the simulated position changes are close to reality However the under and overestimation of the race times show that the tire and fuel model can be improved One reason that the simulated race times di er signi cantly from the actual end times could be that the circuit characteristics are not included in the tire and fuel model It is known that the degradation of a tire compound and the fuel consumption can di er per circuit The race times of the Mexican Grand Prix were overestimated by the simulation model This could be caused by the low tire degradation on the Aut dromo Hermanos Rodr guez circuit because of the altitude of the circuit which is over meters above sea level As a result the loss in lap time because of tire degradation is probably lower than described by the parameters of the tire and fuel model Additional research is needed to investigate why the race times of the Grand Prix of the United States and the Grand Prix of Abu Dhabi are underestimated It could be that the time loss caused by tire degradation is higher than is described by the tire parameters Another reason could be that drivers lose time because of tra c It is for example known that overtaking is quite di cult on the Yas Marina circuit where the Grand Prix of Abu Dhabi is organized As a result drivers can loose a considerable amount of time by being stuck behind another driver By comparing the results of this research to the results of Bekker and Lotz we can conclude that the simulation model performs almost as well in predicting the end positions but worse in predicting the race times The Spearman rank correlation coe cients are somewhat lower than those obtained by Bekker and Lotz However it is di cult to compare the results because Bekker and Lotz s results are based on simulations instead of The simulation model of Bekker and Lotz generates more desirable results for the race times than the simulation model in this research Their results show that there is not enough statistical evidence to reject the null hypothesis that the actual race times and the simulated race times originate from a di erent distribution for all simulated races Also their simulation model does not structurally under or overestimate the race times as is the case for the simulation model in this research This might be caused by the fact that Bekker and Lotz use more circuit speci c data to simulate the lap times We also illustrated how the simulation model can be used by Formula One teams to determine the optimal race strategy among a set of possible strategies These results showed that according to the simulation model the optimal team strategy prior to the race was given by strategy for Nico Rosberg in combi nation with the actual pit stop strategy for Lewis Hamilton for the Japanese Grand Prix Further research can be done to compare the strategies from a game theoretical point of view where one could try to nd the so called Nash equilibrium Further research can also improve the di erent components of the simulation model The fuel and tire model can be improved by including circuit characteristics because the fuel consumption and the tire degradation can di er per circuit Also one could use other data sources such as data from free practice sessions to estimate the fuel and tire parameters These data could improve the fuel and tire model because race data might not as clean as data from for example free practice sessions Ideally you want to use lap time data of drivers in clean air i e not subject to interactions with other drivers to estimate the tire and fuel model However these data is not as easy available as the lap time data from races The DNF probabilities and the mixing of the cars at the start of the race could be estimated more accurately by adding data from previous seasons To improve the DNF probabilities one could for example give a higher weight to recent retirements then to retirement further in the past Comparing the frequentist approach with the Bayesian approach can also be useful for further research To improve the mixing of the cars at the start of the race other methods than the smoothed empirical distribution function can be considered that are more suitable for discrete distribution functions Finally more research on the overtaking parameters can improve the overtaking model One could for example try to optimize the overtaking parameters by using grid search or a meta heuristic We can conclude that the simulation model can be used by Formula One racing teams to compare di erent strategies prior to the race Simulating race results given a particular strategy can help Formula One teams planning and evaluating their race strategies However ideally the simulation model should be able to analyze race strategies in real time such that Formula One teams can adjust their strategies if race incidents occur Formula One teams indeed use such real time simulation models trying to gain competitive advantages References Higginbotham S November How Formula Teams Use Big Data to Win Online no place Fortune Available http fortune com big data formula championship race Accessed August Bekker J Lotz W Planning Formula One race strategies using discrete event simulation Journal of the Operational Research Society Formula One overtaking data Available http cliptheapex com overtaking Accessed August Formula One Database API Available https ergast com Accessed July Pit stop strategy data For example pit stop data from the European Grand Prix Available strategies and pit stops Accessed July http www f fanatic co uk european grand prix tire Qualifying session data For example qualifying times during the qualifying session of the European Grand Prix Available http www fia com events fia formula one world championship season qualifying classification Accessed July Starting grid data For example the starting grid for the European Grand Prix Available grid html Accessed August https www formula com en results html races europe starting Race classi cation data For example race classi cation data of the European Grand Prix Available race classification Accessed August http www fia com events fia formula one world championship season Law A M Kelton W D Simulation modeling and analysis Vol New York McGraw Hill Lebanon G Probability The Analysis of Data Volume Chapter Gelman A et al Bayesian data analysis Vol Boca Raton FL CRC press pages F metrics October Mathematical and statistical insights into Formula Building a Race Simulator Online no place Available https f metrics wordpress com building a race simulator Ac cessed May Pirelli Grand Prix preview For example Pirelli s preview for the Japanese Grand Prix Available http news pirelli com global en ww japan preview Accessed July Pirelli Press Release For example Pirelli s Press Release about the Japanese Grand Prix Qualifying Available prix qualifying Accessed July http www pirelli com corporate en press japanese grand Appendix I Table shows the estimated parameters for each individual driver Fuel Ultrasoft Supersoft Driver Nico Rosberg Lewis Hamilton Sebastian Vettel Kimi Raikkonen Daniel Ricciardo Max Verstappen Felipe Massa Valtteri Bottas Nico Hulkenberg Sergio Perez Kevin Magnussen Jolyon Palmer Daniil Kvyat Carlos Sainz Marcus Ericsson Soft Medium Hard Felipe Nasr Fernando Alonso Jenson Button Pascal Wehrlein Esteban Ocon Romain Grosjean Esteban Gutierrez Table Estimated parameters of the fuel and tire model per driver rounded to decimals Appendix II Table shows the manually collected data on safety car laps during each race from the season Race Australia Bahrein China Russia Spain Monaco Canada Europe Austria Great Britain Germany Belgium Italy Singapore Malaysia Japan United States Mexico Abu Dhabi Virtual Safety car laps Table Safety car laps per race 